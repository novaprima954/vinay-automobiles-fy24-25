<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>View Records - Vinay Automobiles</title>
  <link rel="stylesheet" href="css/common.css">
  <style>
    .filter-section {
      background: #f8f9fa;
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 25px;
      border: 2px solid #e9ecef;
    }

    .filter-section h3 {
      margin: 0 0 20px 0;
      color: #333;
    }

    .filter-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 15px;
    }

    .export-section {
      display: flex;
      justify-content: flex-end;
      margin-top: 15px;
    }

    .btn-export {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      display: none;
    }

    .btn-export:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
    }

    .detail-section {
      margin-bottom: 20px;
    }

    .detail-section-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 12px 15px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 15px;
    }

    .detail-box {
      background: #e3f2fd;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      border-left: 4px solid #1a73e8;
    }

    .payment-summary {
      background: #fff3cd;
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid #ffc107;
    }

    .payment-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #ddd;
    }

    .payment-row:last-child {
      border-bottom: none;
      font-weight: 700;
      font-size: 18px;
      color: #667eea;
    }

    .payment-label {
      font-weight: 600;
      color: #555;
    }

    .payment-value {
      font-weight: 700;
      color: #333;
    }

    @media (max-width: 768px) {
      .filter-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="header-title">
        <span style="font-size: 30px;">üëÅÔ∏è</span>
        <div>
          <h1>View Records</h1>
          <p>Search and view all sales records</p>
        </div>
      </div>
      <div class="header-right">
        <span id="currentUser"></span>
        <button class="btn-secondary" onclick="goBack()">‚Üê Back</button>
      </div>
    </div>

    <div class="content">
      <div id="statusMessage" class="message hidden"></div>

      <!-- Filter Section -->
      <div class="filter-section">
        <h3>üîç Search Filters</h3>
        <div class="filter-grid">
          <div class="form-group">
            <label>Search By:</label>
            <select id="searchBy">
              <option value="">-- Select --</option>
              <option value="Customer Name">Customer Name</option>
              <option value="Mobile No">Mobile No</option>
              <option value="Executive Name">Executive Name</option>
              <option value="Booking Date">Booking Date</option>
            </select>
          </div>

          <div class="form-group" id="searchValueSection">
            <label>Search For:</label>
            <input type="text" id="searchValue" placeholder="Enter search term...">
          </div>

          <div class="form-group" id="dateFilterSection" style="display: none;">
            <label>Date Filter:</label>
            <select id="dateFilter">
              <option value="">-- Select --</option>
              <option value="date">Specific Date</option>
              <option value="range">Date Range</option>
              <option value="month">Month</option>
            </select>
          </div>

          <div class="form-group" id="specificDateSection" style="display: none;">
            <label>Select Date:</label>
            <input type="date" id="specificDate">
          </div>

          <div class="form-group" id="fromDateSection" style="display: none;">
            <label>From Date:</label>
            <input type="date" id="fromDate">
          </div>

          <div class="form-group" id="toDateSection" style="display: none;">
            <label>To Date:</label>
            <input type="date" id="toDate">
          </div>

          <div class="form-group" id="monthSection" style="display: none;">
            <label>Select Month:</label>
            <select id="monthSelector">
              <!-- Populated by JS -->
            </select>
          </div>
        </div>

        <div style="display: flex; gap: 10px;">
          <button class="btn-primary" onclick="searchRecords()" style="flex: 1;">üîç Search</button>
        </div>

        <div class="export-section">
          <button class="btn-export" id="exportBtn" onclick="exportToCSV()">üì• Export to CSV</button>
        </div>
      </div>

      <!-- Results Section -->
      <div id="resultsSection" class="results-section" style="display: none;">
        <h3 id="resultsTitle">Search Results</h3>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Receipt No</th>
                <th>Date</th>
                <th>Customer Name</th>
                <th>Mobile No</th>
                <th>Model</th>
                <th>Variant</th>
              </tr>
            </thead>
            <tbody id="resultsBody"></tbody>
          </table>
        </div>
      </div>

      <!-- Details Section -->
      <div id="detailsSection" class="details-section" style="display: none;">
        <h3>üìã Complete Record Details</h3>

        <!-- Sales Information -->
        <div class="detail-section">
          <div class="detail-section-header">üõí Sales Information</div>
          <div class="detail-box">
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">Receipt No:</span>
                <span class="detail-value" id="detailReceiptNo"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Executive Name:</span>
                <span class="detail-value" id="detailExecName"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Booking Date:</span>
                <span class="detail-value" id="detailDate"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Customer Name:</span>
                <span class="detail-value" id="detailCustomerName"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Mobile No:</span>
                <span class="detail-value" id="detailMobileNo"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Model:</span>
                <span class="detail-value" id="detailModel"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Variant:</span>
                <span class="detail-value" id="detailVariant"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Colour:</span>
                <span class="detail-value" id="detailColour"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Discount:</span>
                <span class="detail-value" id="detailDiscount"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Final Price:</span>
                <span class="detail-value" id="detailFinalPrice"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Financier:</span>
                <span class="detail-value" id="detailFinancier"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Delivery Date:</span>
                <span class="detail-value" id="detailDeliveryDate"></span>
              </div>
              <div class="detail-item" style="grid-column: 1 / -1;">
                <span class="detail-label">Sales Remark:</span>
                <span class="detail-value" id="detailSalesRemark"></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Accessories -->
        <div class="detail-section">
          <div class="detail-section-header">üîß Accessories</div>
          <div class="detail-box">
            <div class="detail-grid" id="accessoriesGrid"></div>
          </div>
        </div>

        <!-- Payment Information -->
        <div class="detail-section">
          <div class="detail-section-header">üí∞ Payment Information</div>
          <div class="payment-summary">
            <div class="payment-row">
              <span class="payment-label">Receipt No 1:</span>
              <span class="payment-value" id="detailReceiptNo1"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Receipt 1 Amount:</span>
              <span class="payment-value" id="detailReceipt1Amount"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Receipt No 2:</span>
              <span class="payment-value" id="detailReceiptNo2"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Receipt 2 Amount:</span>
              <span class="payment-value" id="detailReceipt2Amount"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Receipt No 3:</span>
              <span class="payment-value" id="detailReceiptNo3"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Receipt 3 Amount:</span>
              <span class="payment-value" id="detailReceipt3Amount"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Receipt No 4:</span>
              <span class="payment-value" id="detailReceiptNo4"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Receipt 4 Amount:</span>
              <span class="payment-value" id="detailReceipt4Amount"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">DO Number:</span>
              <span class="payment-value" id="detailDONumber"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Disbursed Amount:</span>
              <span class="payment-value" id="detailDisbursed"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Cash Total:</span>
              <span class="payment-value" id="detailCashTotal"></span>
            </div>
            <div class="payment-row">
              <span class="payment-label">Grand Total:</span>
              <span class="payment-value" id="detailGrandTotal"></span>
            </div>
          </div>
        </div>

        <!-- Accounts Information -->
        <div class="detail-section">
          <div class="detail-section-header">üìä Accounts Information</div>
          <div class="detail-box">
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">Accountant Name:</span>
                <span class="detail-value" id="detailAccountantName"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Account Check:</span>
                <span class="detail-value" id="detailAccountCheck"></span>
              </div>
              <div class="detail-item" style="grid-column: 1 / -1;">
                <span class="detail-label">Account Remark:</span>
                <span class="detail-value" id="detailAccountRemark"></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Accessory Information -->
        <div class="detail-section">
          <div class="detail-section-header">üî© Accessory Information</div>
          <div class="detail-box">
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">Checker Name:</span>
                <span class="detail-value" id="detailAccessoryChecker"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Accessory Fitted:</span>
                <span class="detail-value" id="detailAccessoryFitted"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Accessory Receipt 1:</span>
                <span class="detail-value" id="detailAccessoryReceipt1"></span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Accessory Extra:</span>
                <span class="detail-value" id="detailAccessoryExtra"></span>
              </div>
              <div class="detail-item" style="grid-column: 1 / -1;">
                <span class="detail-label">Pending Items:</span>
                <span class="detail-value" id="detailPending"></span>
              </div>
              <div class="detail-item" style="grid-column: 1 / -1;">
                <span class="detail-label">Accessory Remark:</span>
                <span class="detail-value" id="detailAccessoryRemark"></span>
              </div>
            </div>
          </div>
        </div>

        <div class="button-group">
          <button class="btn-secondary" onclick="closeDetails()">‚úñ Close</button>
        </div>
      </div>
    </div>
  </div>

  <script src="js/config.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/api.js"></script>
  <script src="js/view.js"></script>
</body>
</html>
